{% extends 'base.html' %}

{% block title %}{{ livro.titulo }} - Detalhes{% endblock %}

{% block content %}
<div class="container mt-4">
    <!-- Breadcrumb -->
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{% url 'index' %}">Início</a></li>
            <li class="breadcrumb-item"><a href="{% url 'buscar_livro' %}">Busca</a></li>
            <li class="breadcrumb-item active" aria-current="page">{{ livro.titulo }}</li>
        </ol>
    </nav>

    <div class="row">
        <!-- Imagem do Livro -->
        <div class="col-md-4 mb-4">
            <div class="card border-0">
                <img src="{{ livro.imagem }}"
                     class="card-img-top"
                     alt="Capa de {{ livro.titulo }}"
                     style="height: 500px; object-fit: contain;">
            </div>
        </div>

        <!-- Detalhes do Livro -->
        <div class="col-md-8">
            <div class="card">
                <div class="card-body">
                    <h1 class="card-title mb-3">{{ livro.titulo }}</h1>
                    <h5 class="text-muted mb-4">por {{ livro.autor }}</h5>

                    <!-- Informação do preço (apenas para referência) -->
                    {% if livro.preco %}
                    <div class="mb-4">
                        <h5 class="text-primary">Preço Sugerido</h5>
                        <p>
                            {% if livro.moeda == 'BRL' %}
                                R$ {{ livro.preco|floatformat:2 }}
                            {% else %}
                                {{ livro.moeda }} {{ livro.preco|floatformat:2 }}
                            {% endif %}
                        </p>
                    </div>
                    {% endif %}

                    <div class="mb-4">
                        <h5 class="text-primary">Sobre o Livro</h5>
                        <p>{{ livro.descricao }}</p>
                    </div>

                    <div class="row mb-4">
                        <div class="col-md-6">
                            <h5 class="text-primary">Informações</h5>
                            <ul class="list-unstyled">
                                {% if livro.editora %}
                                    <li><strong>Editora:</strong> {{ livro.editora }}</li>
                                {% endif %}
                                {% if livro.data_publicacao %}
                                    <li><strong>Data de Publicação:</strong> {{ livro.data_publicacao }}</li>
                                {% endif %}
                                {% if livro.numero_paginas %}
                                    <li><strong>Páginas:</strong> {{ livro.numero_paginas }}</li>
                                {% endif %}
                                {% if livro.isbn %}
                                    <li><strong>ISBN:</strong> {{ livro.isbn }}</li>
                                {% endif %}
                                {% if livro.idioma %}
                                    <li><strong>Idioma:</strong> {{ livro.idioma }}</li>
                                {% endif %}
                            </ul>
                        </div>

                        <div class="col-md-6">
                            <h5 class="text-primary">Categorias</h5>
                            {% if livro.categoria %}
                                <p>{{ livro.categoria }}</p>
                            {% else %}
                                <p>Categoria não disponível</p>
                            {% endif %}

                            {% if livro.averageRating %}
                                <h5 class="text-primary mt-3">Avaliação</h5>
                                <div class="mb-2">
                                    {% for i in "12345"|make_list %}
                                        {% if forloop.counter <= livro.averageRating %}
                                            <i class="bi bi-star-fill text-warning"></i>
                                        {% else %}
                                            <i class="bi bi-star text-muted"></i>
                                        {% endif %}
                                    {% endfor %}
                                    <span class="ms-2">({{ livro.averageRating }}/5)</span>
                                </div>
                                <p>{{ livro.ratingsCount }} avaliações</p>
                            {% endif %}
                        </div>
                    </div>

                    <!-- Botões de Ação simplificados -->
                    <div class="d-flex gap-2">
                        {% if livro.link %}
                            <a href="{{ livro.link }}" class="btn btn-primary" target="_blank">
                                <i class="bi bi-google"></i> Ver no Google Books
                            </a>
                        {% endif %}
                        <a href="{% url 'buscar_livro' %}" class="btn btn-outline-secondary">
                            <i class="bi bi-arrow-left"></i> Voltar para Busca
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}